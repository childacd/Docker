很好！🎯你现在打算：

	✅ 放弃密码登录，改为通过 SSH Key 登录容器，并将容器内的 $HOME 目录（如 /home/youruser）挂载到宿主机对应目录上（如 /home/youruser）

这是非常可靠、符合 DevOps 最佳实践的方法。

✅ 最小可行的 SSH Key 登录步骤（概览）
	1.	✅ 宿主机上已有你的 ~/.ssh/id_rsa.pub 公钥
	2.	✅ 将容器中用户的 ~/.ssh/authorized_keys 写入该公钥
	3.	✅ 设置正确权限（非常关键）
	4.	✅ 容器 sshd_config 中启用了公钥认证
	5.	✅ 使用 ssh -i 登录测试

✅ 详细操作步骤

🧱 假设信息
	•	用户名：youruser
	•	宿主机家目录：/home/youruser
	•	宿主机公钥：/home/youruser/.ssh/id_rsa.pub
	•	容器挂载路径：/home/youruser（也就是容器内的 $HOME）

✅ Step 1：构建容器支持 SSH Key 登录（配置 sshd）

在 Dockerfile 里添加：

# 允许公钥登录
RUN sed -i 's/^#\?PubkeyAuthentication.*/PubkeyAuthentication yes/' /etc/ssh/sshd_config && \
    sed -i 's/^#\?PasswordAuthentication.*/PasswordAuthentication no/' /etc/ssh/sshd_config && \
    sed -i 's/^#\?AuthorizedKeysFile.*/AuthorizedKeysFile .ssh\/authorized_keys/' /etc/ssh/sshd_config

这三行设置：
	•	✅ 开启公钥认证
	•	✅ 禁用密码认证（更安全）
	•	✅ 确保默认读取的是 ~/.ssh/authorized_keys

✅ Step 2：运行容器时挂载宿主机 home 到容器中

假设你宿主机用户是 youruser：

docker run -d \
  -p 2222:22 \
  -v /home/youruser:/home/youruser \
  --name ssh-container \
  your-ssh-image

这会把宿主机的 /home/youruser 直接作为容器里 youruser 用户的 $HOME 目录。

✅ Step 3：在宿主机设置 SSH 公钥（如果还没设置）

如果你还没有 key，可以先生成一对：

ssh-keygen -t rsa -b 4096 -f ~/.ssh/id_rsa

然后把公钥放到：

mkdir -p ~/.ssh
cat ~/.ssh/id_rsa.pub >> ~/.ssh/authorized_keys
chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys

（记住这些是在宿主机 /home/youruser 下设置，容器内也会看到）

✅ Step 4：确认容器用户 UID/GID 和宿主机一致

如果你宿主机的 youruser 是 UID 1000、GID 1000，那么容器中创建用户时应匹配：

RUN groupadd -g 1000 youruser && \
    useradd -m -u 1000 -g 1000 -s /bin/bash youruser

否则你会遇到权限错误或 .ssh/authorized_keys 无法读取的问题。

✅ Step 5：登录验证

ssh -i ~/.ssh/id_rsa youruser@localhost -p 2222

如果一切配置正确，你应该直接登录成功，无需输入密码。

✅ SSH Key 登录常见坑 & 验证方法

项目	要求
~/.ssh 目录权限	chmod 700 ~/.ssh
authorized_keys 文件权限	chmod 600 ~/.ssh/authorized_keys
文件 owner	必须是 youruser，不要被 root 占用
容器中 sshd_config 配置正确	PubkeyAuthentication yes，路径为 .ssh/authorized_keys
日志查看（容器内）	tail -f /var/log/auth.log 或 journalctl -u ssh

✅ 附加建议：如果你容器是 Alpine 镜像或无 PAM，使用 dropbear 更轻量；否则 Ubuntu + openssh-server 最靠谱。

需要我为你写一套 Dockerfile + run 脚本，完整实现“宿主机挂载 home + SSH Key 登录容器”的完整 demo 吗？你就可以直接复制粘贴用了。
