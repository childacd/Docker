ä½ é—®çš„è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®æ˜¯ asyncio æ–°æ‰‹æœ€å¸¸è§çš„å›°æƒ‘ï¼š

	â€œasync çš„å‡½æ•°ä¸èƒ½ç›´æ¥è°ƒç”¨ï¼›ä½† await åˆå¿…é¡»åœ¨ async å‡½æ•°é‡Œé¢ç”¨ï¼Œé‚£æˆ‘åˆ°åº•è¦æ€ä¹ˆå¯åŠ¨è¿™ä¸ª async main()ï¼Ÿâ€

ä¸‹é¢æˆ‘ä¼šç”¨éå¸¸æ¸…æ¥šã€ä¸€æ­¥ä¸€æ­¥çš„æ–¹å¼å‘Šè¯‰ä½ ä¸ºä»€ä¹ˆä¼šæŠ¥é”™ã€åº”è¯¥æ€ä¹ˆå†™æ‰æ­£ç¡®ã€‚

âœ… ä¸€å¥è¯æ€»ç»“

ä½ ä¸èƒ½ç›´æ¥è°ƒç”¨ async å‡½æ•°ï¼ˆmain()ï¼‰ï¼Œå¿…é¡»ç”¨ asyncio.run(main()) å¯åŠ¨æ•´ä¸ªäº‹ä»¶å¾ªç¯ã€‚

æ‰€ä»¥ä½ ç»å¯¹ä¸èƒ½è¿™æ ·å†™ï¼š

main()

å¦åˆ™å°±ä¼šæŠ¥ï¼š

RuntimeWarning: coroutine 'main' was never awaited

âœ… æ­£ç¡®å†™æ³•å¿…é¡»æ˜¯è¿™æ ·ï¼š

import asyncio

async def main():
    task1 = asyncio.create_task(work1())
    task2 = asyncio.create_task(work2())

    print("ä»»åŠ¡å·²åˆ›å»ºï¼Œç»§ç»­æ‰§è¡Œå…¶å®ƒä»£ç â€¦")

    await task1
    await task2

asyncio.run(main())   # â† å¯åŠ¨ async ç¨‹åºçš„å…¥å£

â— ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥è°ƒç”¨ main()ï¼Ÿ

å› ä¸ºï¼š

ğŸ”¹ async def main() è¿”å›çš„æ˜¯ä¸€ä¸ª åç¨‹å¯¹è±¡ï¼ˆcoroutineï¼‰

å®ƒä¸æ˜¯æ™®é€šå‡½æ•°ï¼Œä¸èƒ½ç›´æ¥è¿è¡Œï¼Œåªèƒ½è¢«ï¼š
	â€¢	await
	â€¢	æˆ– asyncio.create_task
	â€¢	æˆ– asyncio.run

æ¥é©±åŠ¨æ‰§è¡Œã€‚

ä½ å†™ï¼š

main()

ç­‰äºåªæ˜¯åˆ›å»ºäº†ä¸€ä¸ªåç¨‹å¯¹è±¡ï¼Œä½†ï¼š

âŒ æ²¡æœ‰äº‹ä»¶å¾ªç¯æ¥é©±åŠ¨å®ƒè¿è¡Œ
âŒ ä¹Ÿæ²¡æœ‰ await å®ƒ

æ‰€ä»¥æŠ¥é”™ï¼š

RuntimeWarning: coroutine 'main' was never awaited

â— ä¸ºä»€ä¹ˆä¸èƒ½åœ¨æ™®é€šå‡½æ•°é‡Œç”¨ awaitï¼Ÿ

å› ä¸º await åªèƒ½åœ¨ async def å†…éƒ¨ä½¿ç”¨ã€‚

æ™®é€šå‡½æ•°ï¼ˆé asyncï¼‰æ²¡æœ‰äº‹ä»¶å¾ªç¯ï¼Œæ²¡æ³•ç”¨ awaitã€‚

ğŸ§© è¿™æ˜¯æ•´ä¸ª async ç¨‹åºæ­£ç¡®å¯åŠ¨æµç¨‹

ä½ åº”è¯¥è®°ä½ä¸‹é¢è¿™ä¸ªç»“æ„ï¼š

import asyncio

async def main():
    # ä½ çš„ä»»åŠ¡
    ...

if __name__ == "__main__":
    asyncio.run(main())  # æ­£ç¡®å¯åŠ¨

è¿™æ˜¯ Python 3.7+ å®˜æ–¹æ¨èçš„å†™æ³•ã€‚

ğŸ“Œ ç»“åˆä½ çš„ä»£ç ï¼Œæˆ‘ç»™ä½ è¡¥æˆå®Œæ•´å¯è¿è¡Œç‰ˆæœ¬

ä½ çš„æˆªå›¾é‡Œæ‰€æœ‰ä»£ç éƒ½è¢«æ³¨é‡Šæ‰äº†ï¼Œæˆ‘å¸®ä½ å†™æˆå®Œæ•´çš„ demoï¼š

import asyncio

async def work1():
    print("work1 å¼€å§‹")
    await asyncio.sleep(1)
    print("work1 å®Œæˆ")

async def work2():
    print("work2 å¼€å§‹")
    await asyncio.sleep(2)
    print("work2 å®Œæˆ")

async def main():
    # åˆ›å»ºä»»åŠ¡ï¼ˆç«‹å³å¼€å§‹æ‰§è¡Œï¼‰
    task1 = asyncio.create_task(work1())
    task2 = asyncio.create_task(work2())

    print("ä»»åŠ¡å·²åˆ›å»ºï¼Œç»§ç»­æ‰§è¡Œå…¶å®ƒä»£ç â€¦")

    # ç­‰å¾…ä»»åŠ¡å®Œæˆ
    await task1
    await task2

# æ­£ç¡®å¯åŠ¨ async ç¨‹åº
asyncio.run(main())

è¿è¡Œç»“æœï¼š

ä»»åŠ¡å·²åˆ›å»ºï¼Œç»§ç»­æ‰§è¡Œå…¶å®ƒä»£ç â€¦
work1 å¼€å§‹
work2 å¼€å§‹
work1 å®Œæˆ
work2 å®Œæˆ

ğŸ¯ æƒ³éªŒè¯ä½ çš„ç†è§£å—ï¼Ÿ

ä½ å¯ä»¥æŠŠä½ ç°åœ¨è¿è¡Œæ—¶æŠ¥é”™çš„é‚£ä¸€æ®µè´´ç»™æˆ‘ï¼Œæˆ‘å¸®ä½ æ”¹æˆ 100% æ­£ç¡®ã€å¯è¿è¡Œçš„ç‰ˆæœ¬ã€‚

éšæ—¶å‘æˆ‘ã€‚
