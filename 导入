å¥½çš„ï¼Œæˆ‘å…ˆæ•™ä½  æœ€é€šç”¨ã€æœ€å¿«é€Ÿã€ä»»ä½• Linux éƒ½èƒ½ç”¨çš„æŠ“å–å†…éƒ¨è¯ä¹¦é“¾çš„æ–¹æ³•ï¼Œä½ ç›´æ¥åœ¨ Amazon Linux / Mac / æœ¬åœ° Linux æœºå™¨ä¸Šæ‰§è¡Œå³å¯ã€‚

âœ… æ–¹æ³• 1ï¼šç”¨ openssl æŠ“å–å®Œæ•´è¯ä¹¦é“¾ï¼ˆæœ€å¸¸ç”¨ï¼‰

ğŸ‘‰ è¿è¡Œä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼š

echo | openssl s_client -connect yum-cache.nomura.com:443 -showcerts

å¦‚æœç«¯å£ä¸æ˜¯ 443ï¼Œè¯·æ”¹æˆä½ ä»¬ä»“åº“å®é™…ç«¯å£ã€‚

ğŸ“Œ è¾“å‡ºå†…å®¹

ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ï¼š

CONNECTED(00000003)
---
Certificate chain
 0 s:/CN=yum-cache.nomura.com
   i:/CN=Internal Intermediate CA
-----BEGIN CERTIFICATE-----
ï¼ˆè¯ä¹¦ 0ï¼‰
-----END CERTIFICATE-----
 1 s:/CN=Internal Intermediate CA
   i:/CN=Internal Root CA
-----BEGIN CERTIFICATE-----
ï¼ˆè¯ä¹¦ 1ï¼‰
-----END CERTIFICATE-----
 2 s:/CN=Internal Root CA
   i:/CN=Internal Root CA
-----BEGIN CERTIFICATE-----
ï¼ˆè¯ä¹¦ 2ï¼‰
-----END CERTIFICATE-----
---
SSL handshake has read XXX bytes and written XXX bytes

ä½ éœ€è¦åšçš„æ˜¯ï¼š

âœ” æŠŠæ¯ä¸ª -----BEGIN CERTIFICATE----- åˆ° -----END CERTIFICATE----- çš„å†…å®¹å¤åˆ¶å‡ºæ¥

åˆ†åˆ«ä¿å­˜ä¸ºï¼š

server.crt
intermediate.crt
rootca.crt

é€šå¸¸ä½ åªéœ€è¦ rootCA + intermediateCAã€‚

âœ… æ–¹æ³• 2ï¼šç›´æ¥æŠ“ RootCAï¼ˆæ›´ç²¾ç¡®ï¼‰

å¦‚æœä½ åªæƒ³è¦ issuerï¼ˆä¸Šçº§ CAï¼‰çš„è¯ä¹¦ï¼š

echo | openssl s_client -connect yum-cache.nomura.com:443 -showcerts 2>/dev/null \
  | awk '/BEGIN CERTIFICATE/,/END CERTIFICATE/' > fullchain.pem

ç„¶åä½ å¯ä»¥ç”¨ï¼š

openssl x509 -in fullchain.pem -text -noout

æŸ¥çœ‹æ¯æ®µè¯ä¹¦æ˜¯è°ç­¾çš„ã€‚

âœ… æ–¹æ³• 3ï¼šç”¨æµè§ˆå™¨ä¸‹è½½è¯ä¹¦é“¾ï¼ˆéå¸¸ç®€å•ï¼‰

Chrome / Edgeï¼š
	1.	æ‰“å¼€ URLï¼š
https://yum-cache.nomura.com
	2.	ç‚¹å‡»åœ°å€æ çš„å°é”
	3.	é€‰æ‹© Connection is secure â†’ Certificate is valid
	4.	â€œDetailsâ€
	5.	é€ä¸ªé€‰ Certificate hierarchy çš„æ¯ä¸ªè¯ä¹¦
	6.	ç‚¹å‡» Export â†’ é€‰æ‹© .cer æˆ– .pem

è¿™æ ·ä½ ä¼šå¾—åˆ°ï¼š
	â€¢	Server certificate
	â€¢	Intermediate CA
	â€¢	Root CA

ğŸ“Œ æŠ“åˆ°è¯ä¹¦ä¹‹åï¼Œæˆ‘å†æ•™ä½ ä¸‹ä¸€æ­¥ï¼š

æŠŠè¯ä¹¦æ”¾åˆ°ï¼š

/etc/pki/ca-trust/source/anchors/

ç„¶åï¼š

sudo update-ca-trust

yum å°±ä¼šæ¢å¤æ­£å¸¸è¿è¡Œã€‚

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥å¸®ä½ è§£æä½ æŠ“åˆ°çš„è¯ä¹¦é“¾ï¼ˆæ˜¯å¦å®Œæ•´ã€ç¼ºå°‘å“ªä¸€çº§ï¼‰ã€‚

ä½ æŠ“å®ŒæŠŠå†…å®¹è´´ç»™æˆ‘ï¼Œæˆ‘å¸®ä½ åˆ†æä¸‹ä¸€æ­¥è¯¥æ€ä¹ˆå¯¼å…¥ã€‚
