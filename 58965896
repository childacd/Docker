éå¸¸å¥½ï¼ä½ ç°åœ¨è¦åšçš„ä¸¤ä»¶äº‹ï¼š
	1.	è®°å½•è¯¦ç»†çš„å¼‚å¸¸å†…å®¹ï¼ˆåŒ…æ‹¬é”™è¯¯æ ˆï¼‰
	2.	å¼•å…¥æ­£å¼çš„æ—¥å¿—æ¡†æ¶ï¼Œè®°å½•è¯·æ±‚å¼€å§‹ã€è¯·æ±‚å†…å®¹ã€è¯·æ±‚ç»“æŸï¼Œç±»ä¼¼ç”Ÿäº§ç¯å¢ƒçš„æ—¥å¿—ç»“æ„ã€‚

è¿™æ˜¯ Python é¡¹ç›®é‡Œéå¸¸é‡è¦çš„åŸºç¡€å»ºè®¾ï¼Œä¸‹é¢æˆ‘ä¸€æ­¥ä¸€æ­¥ç»™ä½ ï¼š

âœ… ä¸€ã€æ¨èä½¿ç”¨ Python å†…ç½®çš„ logging æ¡†æ¶

ç›¸æ¯” printï¼š
	â€¢	æ”¯æŒæ—¥å¿—çº§åˆ«ï¼ˆINFO, DEBUG, ERRORï¼‰
	â€¢	æ”¯æŒå†™å…¥æ–‡ä»¶
	â€¢	æ ¼å¼ç»Ÿä¸€
	â€¢	åæœŸå¯ä»¥æ¥å…¥ ELKã€Promtail ç­‰æ—¥å¿—æ”¶é›†ç³»ç»Ÿ

âœ… äºŒã€åŸºç¡€æ—¥å¿—é…ç½®

ä½ å¯ä»¥åœ¨ä½ çš„ Python é¡¹ç›®é‡ŒåŠ è¿™ä¸ªæ—¥å¿—åˆå§‹åŒ–ï¼š

import logging

# æ—¥å¿—åŸºç¡€é…ç½®
logging.basicConfig(
    level=logging.INFO,
    format="%(asctime)s - %(levelname)s - %(message)s",
    handlers=[
        logging.FileHandler("app.log"),   # æ—¥å¿—å†™å…¥æ–‡ä»¶
        logging.StreamHandler()           # æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°
    ]
)

logger = logging.getLogger(__name__)

âœ… ä¸‰ã€API æ—¥å¿—å®Œæ•´ç¤ºä¾‹

å‡è®¾ä½ ç”¨çš„æ˜¯ FastAPIï¼š

from fastapi import FastAPI, HTTPException
from pydantic import BaseModel
import logging
import traceback

app = FastAPI()

# æ—¥å¿—åˆå§‹åŒ–ï¼ˆå»ºè®®å†™åˆ°å•ç‹¬æ–‡ä»¶ï¼‰
logging.basicConfig(
    level=logging.INFO,
    format="%(asctime)s - %(levelname)s - %(message)s",
    handlers=[
        logging.FileHandler("app.log"),
        logging.StreamHandler()
    ]
)
logger = logging.getLogger(__name__)

class CopyRequest(BaseModel):
    source_type: str
    source_bucket: str
    source_object: str
    destination_type: str
    destination_bucket: str
    destination_object: str

@app.post("/copy")
async def copy_file(copy_request: CopyRequest):
    logger.info(f"ğŸ“¥ Received request: {copy_request.dict()}")

    try:
        logger.info("ğŸš€ Start processing copy...")

        # è¿™é‡Œæ˜¯ä½ çš„å¤åˆ¶é€»è¾‘
        if copy_request.source_type == "s3":
            logger.info("Downloading from S3...")
            # è°ƒç”¨ä¸‹è½½å‡½æ•°
        elif copy_request.source_type == "minio":
            logger.info("Downloading from Minio...")
            # è°ƒç”¨ä¸‹è½½å‡½æ•°
        else:
            raise ValueError("Unsupported source type")

        # ä¸Šä¼ é€»è¾‘
        logger.info("Uploading to destination...")

        logger.info("âœ… Copy operation completed successfully.")
        return {"message": "File copied successfully."}

    except Exception as e:
        logger.error("âŒ Error occurred during copy: %s", str(e))
        logger.error("âŒ Traceback:\n%s", traceback.format_exc())
        raise HTTPException(status_code=500, detail=str(e))

âœ… å››ã€é‡ç‚¹è®²è§£

åŠŸèƒ½	å®ç°
æ—¥å¿—è®°å½•	logger.info è®°å½•å…³é”®æ­¥éª¤
è¯·æ±‚å†…å®¹	copy_request.dict() ç›´æ¥æ‰“å‡ºæ¥
é”™è¯¯æ ˆ	traceback.format_exc() æ‰“å°å®Œæ•´æŠ¥é”™å †æ ˆ
æ—¥å¿—æ ¼å¼	%(asctime)s - %(levelname)s - %(message)s æ ¼å¼ç»Ÿä¸€
æ—¥å¿—è¾“å‡º	åŒæ—¶å†™åˆ° app.log æ–‡ä»¶å’Œæ§åˆ¶å°

âœ… äº”ã€å»ºè®®çš„æ—¥å¿—ç­‰çº§ç”¨æ³•

æ—¥å¿—ç­‰çº§	é€‚ç”¨åœºæ™¯
DEBUG	è¯¦ç»†æµç¨‹ã€å‚æ•°æ£€æŸ¥
INFO	å…³é”®æ­¥éª¤ã€è¯·æ±‚å…¥å‚ã€æˆåŠŸç»“æŸ
WARNING	éè‡´å‘½é—®é¢˜
ERROR	å¼‚å¸¸å¤„ç†ã€é”™è¯¯æ—¥å¿—
CRITICAL	ä¸¥é‡é”™è¯¯ï¼ˆä¸€èˆ¬ç”¨ä¸åˆ°ï¼‰

âœ… Bonus: æ—¥å¿—æŒ‰å¤©åˆ‡å‰²ï¼ˆå¯é€‰ï¼‰

åæœŸå¯ä»¥ç”¨ TimedRotatingFileHandlerï¼Œæ¯”å¦‚æ¯å¤©ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼š

from logging.handlers import TimedRotatingFileHandler

handler = TimedRotatingFileHandler("app.log", when="midnight", interval=1, backupCount=7)
handler.suffix = "%Y-%m-%d"
logging.basicConfig(
    handlers=[handler, logging.StreamHandler()],
    level=logging.INFO,
    format="%(asctime)s - %(levelname)s - %(message)s"
)

è¿™æ ·æ—¥å¿—ä¼šæ¯å¤©åˆ‡ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œæœ€å¤šä¿ç•™ 7 å¤©ã€‚

ğŸ”¥ æ€»ç»“

éœ€æ±‚	æ–¹æ¡ˆ
è®°å½•è¯·æ±‚æ—¥å¿—	logger.info(f"Request: {copy_request.dict()}")
è®°å½•å¼‚å¸¸è¯¦æƒ…	logger.error("âŒ Traceback:\n%s", traceback.format_exc())
ç»Ÿä¸€æ—¥å¿—è¾“å‡º	logging.basicConfig é…ç½®å†™å…¥æ–‡ä»¶å’Œæ§åˆ¶å°

å¦‚æœä½ è¦ï¼Œæˆ‘å¯ä»¥å¸®ä½ ï¼š
	â€¢	å®Œæ•´æ•´ç†ä½ çš„é¡¹ç›®ç»“æ„ + æ—¥å¿—å·¥å…·ç±»
	â€¢	å†™ä¸€ä¸ªæ”¯æŒå®šæ—¶åˆ‡å‰² + å¤šç¯å¢ƒæ—¥å¿—é…ç½®çš„ logger æ¨¡æ¿

éšæ—¶å‘Šè¯‰æˆ‘ï¼
